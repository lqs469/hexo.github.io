<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  
  <title>JavaScript ES2018/ES9 新增标准 | lqs469</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="6 月 27 号, TC39 正式完成了ES2018/ES9 的语言规范 开始进入 ES2019 阶段.最终阶段详情: finished-proposals来看看 ES2018 比之前的 ES2017 新增了哪些规范. Object Rest/Spread Properties对于对象的 Rest/Spread, 而之前标准只有数组是支持的. 说出来你可能不信, 这是 ES9 的特性, 我感觉都已">
<meta property="og:type" content="article">
<meta property="og:title" content="JavaScript ES2018&#x2F;ES9 新增标准">
<meta property="og:url" content="http://yoursite.com/2018/06/29/JavaScript-ES2018-ES9-新增标准/index.html">
<meta property="og:site_name" content="lqs469">
<meta property="og:description" content="6 月 27 号, TC39 正式完成了ES2018/ES9 的语言规范 开始进入 ES2019 阶段.最终阶段详情: finished-proposals来看看 ES2018 比之前的 ES2017 新增了哪些规范. Object Rest/Spread Properties对于对象的 Rest/Spread, 而之前标准只有数组是支持的. 说出来你可能不信, 这是 ES9 的特性, 我感觉都已">
<meta property="og:updated_time" content="2018-06-29T14:27:44.699Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JavaScript ES2018&#x2F;ES9 新增标准">
<meta name="twitter:description" content="6 月 27 号, TC39 正式完成了ES2018/ES9 的语言规范 开始进入 ES2019 阶段.最终阶段详情: finished-proposals来看看 ES2018 比之前的 ES2017 新增了哪些规范. Object Rest/Spread Properties对于对象的 Rest/Spread, 而之前标准只有数组是支持的. 说出来你可能不信, 这是 ES9 的特性, 我感觉都已">
  
  
    <link rel="icon" href="/favicon.ico">
  
  <link rel="stylesheet" href="/css/typing.css">
  
</head>

  
    
      <body>
    
  
      <div id="container" class="container">
        <article id="post-JavaScript-ES2018-ES9-新增标准" class="article article-type-post" itemscope itemprop="blogPost">
  <header id="header" class="header">
  <nav id="main-nav" class="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/archives">Archives</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
</header>

  <hr/>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      JavaScript ES2018/ES9 新增标准
    </h1>
  

      </header>
    
    <div class="article-entry typo" itemprop="articleBody">
      
        <p>6 月 27 号, TC39 正式完成了<a href="https://tc39.github.io/ecma262/" target="_blank" rel="external">ES2018/ES9 的语言规范</a> 开始进入 ES2019 阶段.<br>最终阶段详情: <a href="https://github.com/tc39/proposals/blob/master/finished-proposals.md" target="_blank" rel="external">finished-proposals</a><br>来看看 ES2018 比之前的 ES2017 新增了哪些规范.</p>
<h2 id="Object-Rest-Spread-Properties"><a href="#Object-Rest-Spread-Properties" class="headerlink" title="Object Rest/Spread Properties"></a>Object Rest/Spread Properties</h2><p>对于对象的 Rest/Spread, 而之前标准只有数组是支持的. 说出来你可能不信, 这是 ES9 的特性, 我感觉都已经用了很久了…</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> obj = &#123;<span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span>, <span class="attr">z</span>: <span class="number">3</span>&#125;</div><div class="line"><span class="keyword">const</span> &#123;x, ...rest&#125; = obj</div><div class="line"><span class="comment">// x = 1, rest = &#123; y: 2, z: 3 &#125;</span></div></pre></td></tr></table></figure>
<p>很实用的一点比如 React props 可以这样写</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">render () &#123;</div><div class="line">	<span class="keyword">const</span> &#123; x, ...props &#125; = <span class="keyword">this</span>.props</div><div class="line">	<span class="keyword">return</span> &lt;div &#123;...props&#125; /&gt;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Asynchronous-Iteration-异步迭代器"><a href="#Asynchronous-Iteration-异步迭代器" class="headerlink" title="Asynchronous Iteration 异步迭代器"></a>Asynchronous Iteration 异步迭代器</h2><p>神奇的异步迭代器, 如果你之前这样写, 循环会依旧保持同步, 而异步独立于循环外, 为什么会导致这个情况想明白这个机制的同学可以去了解一下 js 事件循环.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">for</span> <span class="keyword">await</span> (<span class="keyword">const</span> line <span class="keyword">of</span> readLines(file)) &#123;</div><div class="line">  	<span class="comment">// line by line</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Promise-prototype-finally"><a href="#Promise-prototype-finally" class="headerlink" title="Promise.prototype.finally()"></a>Promise.prototype.finally()</h2><p>又一个以为早就有的特性, 当<code>promise</code>结束时稳定被触发(无论<code>resolve</code>, <code>reject</code>), 几乎是扫尾工作专用方法.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">fetch()</div><div class="line">  .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;)</div><div class="line">  .finally(Fn)</div></pre></td></tr></table></figure>
<h2 id="一系列正则优化"><a href="#一系列正则优化" class="headerlink" title="一系列正则优化"></a>一系列正则优化</h2><h3 id="s-标志和-dotAll-模式"><a href="#s-标志和-dotAll-模式" class="headerlink" title="s 标志和 dotAll 模式"></a><code>s</code> 标志和 <code>dotAll</code> 模式</h3><p>之前 <code>.</code> 用于匹配任何单字符, 但有两个例外:</p>
<ol>
<li><p>无法匹配行结束符</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">;<span class="regexp">/foo.bar/</span>.test(<span class="string">'foo\nbar'</span>)</div><div class="line"><span class="comment">// → false</span></div></pre></td></tr></table></figure>
<p>行终结符:</p>
<ul>
<li>U+000A LINE FEED (LF) (\n) - 换行</li>
<li>U+000D CARRIAGE RETURN (CR) (\r) - 回车</li>
<li>U+2028 LINE SEPARATOR - 行分隔符</li>
<li>U+2029 PARAGRAPH SEPARATOR - 段分隔符<br>以及:</li>
<li>U+000B VERTICAL TAB (\v)</li>
<li>U+000C FORM FEED (\f)</li>
<li>U+0085 NEXT LINE</li>
</ul>
</li>
<li><p>多字节字符(非 BMP), 比如 Emoji:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">;<span class="regexp">/^.$/</span>.test(<span class="string">'😀'</span>)</div><div class="line"><span class="comment">// → false</span></div></pre></td></tr></table></figure>
<p>曾经可以通过 <code>/u</code> 解决:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">;<span class="regexp">/^.$/u</span>.test(<span class="string">'😀'</span>)</div><div class="line"><span class="comment">// → true</span></div></pre></td></tr></table></figure>
</li>
</ol>
<p>而在 ES9 中，新增加了一个新的标志 <code>s</code>, 让 <code>.</code> 可以匹配任意单字符.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> re = <span class="regexp">/foo.bar/</span>s <span class="comment">// Or, `const re = new RegExp('foo.bar', 's');`.</span></div><div class="line">re.test(<span class="string">'foo\nbar'</span>)</div><div class="line"><span class="comment">// → true</span></div><div class="line">re.dotAll</div><div class="line"><span class="comment">// → true</span></div><div class="line">re.flags</div><div class="line"><span class="comment">// → 's'</span></div></pre></td></tr></table></figure>
<h3 id="命名捕获组-RegExp-Named-Capture-Groups"><a href="#命名捕获组-RegExp-Named-Capture-Groups" class="headerlink" title="命名捕获组(RegExp Named Capture Groups)"></a>命名捕获组(RegExp Named Capture Groups)</h3><p>以前:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> regex = <span class="regexp">/(\d&#123;4&#125;)-(\d&#123;2&#125;)-(\d&#123;2&#125;)/</span></div><div class="line"><span class="keyword">const</span> matchers = regex.exec(<span class="string">'2015-01-02'</span>)</div><div class="line">matchers[<span class="number">0</span>] <span class="comment">// 2015-01-02</span></div><div class="line">matchers[<span class="number">1</span>] <span class="comment">// 2015</span></div><div class="line">matchers[<span class="number">2</span>] <span class="comment">// 01</span></div><div class="line">matchers[<span class="number">3</span>] <span class="comment">// 02</span></div></pre></td></tr></table></figure>
<p>现在:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> re = <span class="regexp">/(?&lt;year&gt;\d&#123;4&#125;)-(?&lt;month&gt;\d&#123;2&#125;)-(?&lt;day&gt;\d&#123;2&#125;)/u</span></div><div class="line"><span class="keyword">let</span> result = re.exec(<span class="string">'2015-01-02'</span>)</div><div class="line"><span class="comment">// result.groups.year === '2015';</span></div><div class="line"><span class="comment">// result.groups.month === '01';</span></div><div class="line"><span class="comment">// result.groups.day === '02';</span></div><div class="line"></div><div class="line"><span class="comment">// result[0] === '2015-01-02';</span></div><div class="line"><span class="comment">// result[1] === '2015';</span></div><div class="line"><span class="comment">// result[2] === '01';</span></div><div class="line"><span class="comment">// result[3] === '02';</span></div></pre></td></tr></table></figure>
<p>解构一起用:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> &#123;</div><div class="line">  groups: &#123;one, two&#125;,</div><div class="line">&#125; = <span class="regexp">/^(?&lt;one&gt;.*):(?&lt;two&gt;.*)$/u</span>.exec(<span class="string">'foo:bar'</span>)</div><div class="line"><span class="built_in">console</span>.log(<span class="string">`one: <span class="subst">$&#123;one&#125;</span>, two: <span class="subst">$&#123;two&#125;</span>`</span>) <span class="comment">// prints one: foo, two: bar</span></div></pre></td></tr></table></figure></p>
<p>反向引用:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">let duplicate = /^(?&lt;half&gt;.*).\k&lt;half&gt;$/u;</div><div class="line">duplicate.test(&apos;a*b&apos;); // false</div><div class="line">duplicate.test(&apos;a*a&apos;); // true</div></pre></td></tr></table></figure>
<p>跟数字捕获组一起使用:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">let triplicate = /^(?&lt;part&gt;.*).\k&lt;part&gt;.\1$/u;</div><div class="line">triplicate.test(&apos;a*a*a&apos;); // true</div><div class="line">triplicate.test(&apos;a*a*b&apos;); // false</div></pre></td></tr></table></figure>
<p>替换字符</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">let re = /(?&lt;year&gt;\d&#123;4&#125;)-(?&lt;month&gt;\d&#123;2&#125;)-(?&lt;day&gt;\d&#123;2&#125;)/u;</div><div class="line">let result = &apos;2015-01-02&apos;.replace(re, &apos;$&lt;day&gt;/$&lt;month&gt;/$&lt;year&gt;&apos;);</div><div class="line">// result === &apos;02/01/2015&apos;</div></pre></td></tr></table></figure>
<h3 id="反向断言-RegExp-Lookbehind-Assertions"><a href="#反向断言-RegExp-Lookbehind-Assertions" class="headerlink" title="反向断言(RegExp Lookbehind Assertions)"></a>反向断言(RegExp Lookbehind Assertions)</h3><p>以往只支持正向断言, 现在支持了反向断言, 语法是 <code>(?&lt;=...)</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/(?&lt;=\$)\d+(\.\d*)?/</div></pre></td></tr></table></figure>
<p>这个例子会匹配 <code>&#39;$10.53&#39;</code> 捕获返回 <code>&#39;10.53&#39;</code>, 但不会匹配 <code>€10.53</code>.</p>
<h3 id="Unicode转义-RegExp-Unicode-Property-Escapes"><a href="#Unicode转义-RegExp-Unicode-Property-Escapes" class="headerlink" title="Unicode转义(RegExp Unicode Property Escapes)"></a>Unicode转义(RegExp Unicode Property Escapes)</h3><p>设置<code>\p{Script_Extensions}</code> 或 <code>\P{Script_Extensions}</code>, 使得在 JS 的正则中使用 Unicode 字符, 包括一些奇奇怪怪的字符. 举个例子比如希腊字母:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> regexGreekSymbol = <span class="regexp">/\p&#123;Script_Extensions=Greek&#125;/u</span></div><div class="line">regexGreekSymbol.test(<span class="string">'π'</span>)</div><div class="line"><span class="comment">// → true</span></div></pre></td></tr></table></figure>
<h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>目前大部分特性已经应用于主流浏览器了, 甚至有的早早就有, 也有一些正在实现过程中的. 但如果遇到要解决兼容性的问题还是得老老实实查 MDN, caniuse. 而 Node 端依然落后于标准设计, 这个有历史原因也有稳定性的要求. 新的标准出来的速度快其实大家也不用捉急, 原因在于生产中大部分时候我们其实用不到最新的标准, 或者已有其他的途径或老方法解决掉问题. 写出炫酷的代码不一定是最重要的, 能够解决掉问题才是最重要的. 而新标准更多的意义在于遇到真正刁钻问题的时候能够有解决方法或语言支持, 以及对代码抽象能力的提升, 性能的优化等.</p>

      
    </div>
    <footer class="article-footer">
      <ul class="article-meta">
        <li>
          <span class="label">Published Date:</span>
          <a href="/2018/06/29/JavaScript-ES2018-ES9-新增标准/" class="article-date">
  <time datetime="2018-06-29T14:14:06.000Z" itemprop="datePublished">Jun 2018</time>
</a>

        </li>
        
          <li>
            <span class="label">Categoría:</span>
            
  <div class="article-category">
    <a class="article-category-link" href="/categories/弱鸡之路/">弱鸡之路</a>
  </div>


          </li>
        
        
        <hr/>
      </ul>
    </footer>
  </div>
  
    
<nav id="article-nav" class="article-nav">
  
    <span id="article-nav-newer" class="article-nav-link-wrap newer"></span>
  
  
    <a href="/2018/06/15/土豆🥔周报生成器/" id="article-nav-older" class="article-nav-link-wrap older">
      <strong class="article-nav-caption">Viejo</strong>
      <div class="article-nav-title">土豆🥔周报生成器</div>
    </a>
  
</nav>


  
</article>






      </div>
      
    <footer id="footer" class="post-footer footer">
      
      <hr/>
      <div id="footerContent" class="footer-content">
        

      </div>
    </footer>

      



<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/typing.js"></script>
<!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->






<script type="text/javascript">
  console.log('anlysis')
  var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
  document.write(unescape("%3Cspan id='cnzz_stat_icon_1264607064'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s19.cnzz.com/z_stat.php%3Fid%3D1264607064' type='text/javascript'%3E%3C/script%3E"));
</script>

    </div>
  </body>
</html>
