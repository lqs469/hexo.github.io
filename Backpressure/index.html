<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.75 'PingFang SC','Helvetica Neue','Microsoft YaHei','Source Han Sans SC',serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.9);font-family:'PingFang SC','Helvetica Neue','Microsoft YaHei','Source Han Sans SC',serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:PingFang SC,Helvetica Neue,Microsoft YaHei,Source Han Sans SC,serif;font-weight:900;text-rendering:optimizeLegibility;font-size:2.5rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'PingFang SC','Helvetica Neue','Microsoft YaHei','Source Han Sans SC',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.73286rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'PingFang SC','Helvetica Neue','Microsoft YaHei','Source Han Sans SC',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.4427rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'PingFang SC','Helvetica Neue','Microsoft YaHei','Source Han Sans SC',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;letter-spacing:0.140625em;text-transform:uppercase;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'PingFang SC','Helvetica Neue','Microsoft YaHei','Source Han Sans SC',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.83255rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'PingFang SC','Helvetica Neue','Microsoft YaHei','Source Han Sans SC',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.75966rem;line-height:1.1;font-style:italic;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}ul{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;list-style:disc;}ol{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:0.85rem;line-height:1.75rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1rem;line-height:1.75rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}blockquote{margin-left:-1.75rem;margin-right:1.75rem;margin-top:0;padding-bottom:0;padding-left:1.42188rem;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1.20112rem;line-height:1.75rem;color:hsla(0,0%,0%,0.59);font-style:italic;border-left:0.32813rem solid hsla(0,0%,0%,0.9);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.75rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.75rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}li > ul{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.75rem / 2);}code{font-size:0.85rem;line-height:1.75rem;}kbd{font-size:0.85rem;line-height:1.75rem;}samp{font-size:0.85rem;line-height:1.75rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.16667rem;padding-right:1.16667rem;padding-top:0.875rem;padding-bottom:calc(0.875rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.75rem;color:hsla(0,0%,0%,0.9);font-weight:400;}blockquote cite:before{content:"â€” ";}ul,ol{margin-left:0;}@media only screen and (max-width:480px){ul,ol{margin-left:1.75rem;}blockquote{margin-left:-1.3125rem;margin-right:0;padding-left:0.98438rem;}}h1,h2,h3,h4,h5,h6{margin-top:3.5rem;}a{box-shadow:0 1px 0 0 currentColor;color:#007acc;text-decoration:none;}a:hover,a:active{box-shadow:none;}mark,ins{background:#007acc;color:white;padding:0.10938rem 0.21875rem;text-decoration:none;}a.gatsby-resp-image-link{box-shadow:none;}</style><style data-href="/styles.e56693dc83003c76a0a9.css">body{--pink:#ffa7c4;--bg:#fff;background-color:var(--bg)}h1,h2,h3,h4,li,p,small,span{color:#393e46;color:var(--textNormal)}a{color:#00adb5}body.light{--bg:#fff;--header:var(--pink);--textNormal:#222;--textTitle:#222;--textLink:#d23669;--hr:rgba(0,0,0,0.2);--inlineCode-bg:rgba(255,229,100,0.3);--inlineCode-text:#1a1a1a}body.dark{-webkit-font-smoothing:antialiased;--bg:#282c35;--header:#fff;--textNormal:hsla(0,0%,100%,0.88);--textTitle:#fff;--textLink:var(--pink);--hr:hsla(0,0%,100%,0.2);--inlineCode-bg:#586074;--inlineCode-text:#e6e6e6}code[class*=language-],pre[class*=language-]{color:#fff;background:none;font-family:Consolas,Menlo,Monaco,source-code-pro,Courier New,monospace;font-feature-settings:normal;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;margin-bottom:0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{overflow:auto;padding:1em}pre[class*=language-]::selection{background:#27292a}pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:hsla(0,0%,100%,.15)}:not(pre)>code[class*=language-]{border-radius:.3em;background:var(--inlineCode-bg);color:var(--inlineCode-text);padding:.15em .2em .05em;white-space:normal}.token.attr-name{color:#addb67;font-style:italic}.token.comment{color:#637777}.token.string,.token.url{color:#addb67}.token.variable{color:#d6deeb}.token.number{color:#f78c6c}.token.builtin,.token.char,.token.constant,.token.function{color:#82aaff}.token.punctuation{color:#c792ea}.token.doctype,.token.selector{color:#c792ea;font-style:"italic"}.token.class-name{color:#ffcb8b}.token.keyword,.token.operator,.token.tag{color:#ffa7c4}.token.boolean{color:#ff5874}.token.property{color:#80cbc4}.token.namespace{color:#b2ccd6}pre[data-line]{padding:1em 0 1em 3em;position:relative}.gatsby-highlight-code-line{background-color:#022a4b;display:block;margin-right:-1em;margin-left:-1em;padding-right:1em;padding-left:.75em;border-left:.25em solid #ffa7c4}.gatsby-highlight{margin-bottom:1.75rem;border-radius:10px;background:#011627;-webkit-overflow-scrolling:touch;overflow:auto}.gatsby-highlight pre[class*=language-]{float:left;min-width:100%}</style><meta name="generator" content="Gatsby 2.24.65"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=0257130576977213eca55ce954451317" type="image/png"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#65c6c4"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=0257130576977213eca55ce954451317"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=0257130576977213eca55ce954451317"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=0257130576977213eca55ce954451317"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=0257130576977213eca55ce954451317"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=0257130576977213eca55ce954451317"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=0257130576977213eca55ce954451317"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=0257130576977213eca55ce954451317"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=0257130576977213eca55ce954451317"/><title data-react-helmet="true">Node.js Streams ä¸­çš„èƒŒå‹(backpressure) | lqs469</title><meta data-react-helmet="true" name="description" content="åŸæ–‡ æ•°æ®å¤„ç†è¿‡ç¨‹ä¸­ç»å¸¸å‡ºç°ä¸€ä¸ªç§°ä¸ºèƒŒå‹(backpressure)çš„å¸¸è§é—®é¢˜ï¼Œç”¨æ¥æè¿°æ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­ç¼“å†²åŒºåé¢çš„æ•°æ®ç´¯ç§¯ã€‚å½“ä¼ é€çš„æ¥æ”¶ç«¯æ“ä½œå¤æ‚æ—¶ï¼Œæˆ–è€…ç”±äºæŸç§åŸå› è€Œè¾ƒæ…¢æ—¶ï¼Œæ¥è‡ªä¼ å…¥æºçš„æ•°æ®æœ‰ç§¯èšçš„è¶‹åŠ¿ï¼Œå¦‚å µå¡ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¿…é¡»æœ‰ä¸€ä¸ªæˆæƒç³»ç»Ÿæ¥ç¡®ä¿ä»ä¸€ä¸ªæºåˆ°å¦ä¸€ä¸ªæºçš„æ•°æ®çš„å¹³æ»‘æµåŠ¨ã€‚ä¸åŒçš„ç¤¾åŒºæœ‰æ ¹æ®å…¶ç¨‹åºç‰¹ç‚¹çš„ç‹¬ç‰¹è§£å†³æ–¹æ¡ˆï¼ŒUnix pipes å’Œ TCP socketsâ€¦"/><meta data-react-helmet="true" property="og:title" content="Node.js Streams ä¸­çš„èƒŒå‹(backpressure)"/><meta data-react-helmet="true" property="og:description" content="åŸæ–‡ æ•°æ®å¤„ç†è¿‡ç¨‹ä¸­ç»å¸¸å‡ºç°ä¸€ä¸ªç§°ä¸ºèƒŒå‹(backpressure)çš„å¸¸è§é—®é¢˜ï¼Œç”¨æ¥æè¿°æ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­ç¼“å†²åŒºåé¢çš„æ•°æ®ç´¯ç§¯ã€‚å½“ä¼ é€çš„æ¥æ”¶ç«¯æ“ä½œå¤æ‚æ—¶ï¼Œæˆ–è€…ç”±äºæŸç§åŸå› è€Œè¾ƒæ…¢æ—¶ï¼Œæ¥è‡ªä¼ å…¥æºçš„æ•°æ®æœ‰ç§¯èšçš„è¶‹åŠ¿ï¼Œå¦‚å µå¡ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¿…é¡»æœ‰ä¸€ä¸ªæˆæƒç³»ç»Ÿæ¥ç¡®ä¿ä»ä¸€ä¸ªæºåˆ°å¦ä¸€ä¸ªæºçš„æ•°æ®çš„å¹³æ»‘æµåŠ¨ã€‚ä¸åŒçš„ç¤¾åŒºæœ‰æ ¹æ®å…¶ç¨‹åºç‰¹ç‚¹çš„ç‹¬ç‰¹è§£å†³æ–¹æ¡ˆï¼ŒUnix pipes å’Œ TCP socketsâ€¦"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Qinshuo(Allen) Li"/><meta data-react-helmet="true" name="twitter:title" content="Node.js Streams ä¸­çš„èƒŒå‹(backpressure)"/><meta data-react-helmet="true" name="twitter:description" content="åŸæ–‡ æ•°æ®å¤„ç†è¿‡ç¨‹ä¸­ç»å¸¸å‡ºç°ä¸€ä¸ªç§°ä¸ºèƒŒå‹(backpressure)çš„å¸¸è§é—®é¢˜ï¼Œç”¨æ¥æè¿°æ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­ç¼“å†²åŒºåé¢çš„æ•°æ®ç´¯ç§¯ã€‚å½“ä¼ é€çš„æ¥æ”¶ç«¯æ“ä½œå¤æ‚æ—¶ï¼Œæˆ–è€…ç”±äºæŸç§åŸå› è€Œè¾ƒæ…¢æ—¶ï¼Œæ¥è‡ªä¼ å…¥æºçš„æ•°æ®æœ‰ç§¯èšçš„è¶‹åŠ¿ï¼Œå¦‚å µå¡ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¿…é¡»æœ‰ä¸€ä¸ªæˆæƒç³»ç»Ÿæ¥ç¡®ä¿ä»ä¸€ä¸ªæºåˆ°å¦ä¸€ä¸ªæºçš„æ•°æ®çš„å¹³æ»‘æµåŠ¨ã€‚ä¸åŒçš„ç¤¾åŒºæœ‰æ ¹æ®å…¶ç¨‹åºç‰¹ç‚¹çš„ç‹¬ç‰¹è§£å†³æ–¹æ¡ˆï¼ŒUnix pipes å’Œ TCP socketsâ€¦"/><link as="script" rel="preload" href="/webpack-runtime-037708c35ad0d69f813e.js"/><link as="script" rel="preload" href="/81884799-5d3dbc1bedd73895a97b.js"/><link as="script" rel="preload" href="/42aef400-233a8540e28c5aa0dda4.js"/><link as="script" rel="preload" href="/app-c5b6662e244d0f222903.js"/><link as="script" rel="preload" href="/styles-e9d24b1846c7d6eb9685.js"/><link as="script" rel="preload" href="/73d3d9e0165615ec1a5fd45b6214bc89c496d04c-6650e6e8db9e28320e98.js"/><link as="script" rel="preload" href="/3ff1db7653220f4faedd8b2ce788c941d30183fc-338a1c97b480401706c3.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-9409cd8b6b71cd967860.js"/><link as="fetch" rel="preload" href="/page-data/Backpressure/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2113486316.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/63159454.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body class="light"><div id="___gatsby">
            <div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div style="margin-left:auto;margin-right:auto;max-width:43.75rem;padding:2.625rem 1.3125rem"><header style="margin-top:1.75rem;margin-bottom:3.5rem"><a style="font-size:1.25743rem;line-height:1.75rem;box-shadow:none;text-decoration:none;color:rgb(255, 10, 120);font-weight:bolder;margin-right:2.625rem;text-transform:capitalize" href="/">lqs469</a><a style="font-size:1.25743rem;line-height:1.75rem;box-shadow:none;text-decoration:none;color:var(--textNormal);font-weight:bolder;margin-right:1.75rem" href="/post">Posts</a><a style="font-size:1.25743rem;line-height:1.75rem;box-shadow:none;text-decoration:none;color:var(--textNormal);font-weight:bolder;margin-right:1.75rem" href="/project">Projects</a><span style="cursor:pointer;float:right">ğŸŒ™</span></header><main><h1>Node.js Streams ä¸­çš„èƒŒå‹(backpressure)</h1><p style="font-size:0.83255rem;line-height:1.75rem;display:block;margin-bottom:1.75rem;margin-top:-1.75rem">July 03, 2018<!-- --> <!-- -->å¼±é¸¡ä¹‹è·¯</p><div><p><a href="https://nodejs.org/en/docs/guides/backpressuring-in-streams/">åŸæ–‡</a></p>
<p>æ•°æ®å¤„ç†è¿‡ç¨‹ä¸­ç»å¸¸å‡ºç°ä¸€ä¸ªç§°ä¸º<strong>èƒŒå‹(backpressure)</strong>çš„å¸¸è§é—®é¢˜ï¼Œç”¨æ¥æè¿°æ•°æ®ä¼ è¾“è¿‡ç¨‹ä¸­ç¼“å†²åŒºåé¢çš„æ•°æ®ç´¯ç§¯ã€‚å½“ä¼ é€çš„æ¥æ”¶ç«¯æ“ä½œå¤æ‚æ—¶ï¼Œæˆ–è€…ç”±äºæŸç§åŸå› è€Œè¾ƒæ…¢æ—¶ï¼Œæ¥è‡ªä¼ å…¥æºçš„æ•°æ®æœ‰ç§¯èšçš„è¶‹åŠ¿ï¼Œå¦‚å µå¡ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¿…é¡»æœ‰ä¸€ä¸ªæˆæƒç³»ç»Ÿæ¥ç¡®ä¿ä»ä¸€ä¸ªæºåˆ°å¦ä¸€ä¸ªæºçš„æ•°æ®çš„å¹³æ»‘æµåŠ¨ã€‚ä¸åŒçš„ç¤¾åŒºæœ‰æ ¹æ®å…¶ç¨‹åºç‰¹ç‚¹çš„ç‹¬ç‰¹è§£å†³æ–¹æ¡ˆï¼ŒUnix pipes å’Œ TCP sockets å°±æ˜¯è¿™æ–¹é¢çš„å¾ˆå¥½çš„ä¾‹å­ï¼Œå¹¶ä¸”é€šå¸¸è¢«ç§°ä¸ºæµé‡æ§åˆ¶ã€‚åœ¨Node.jsä¸­ï¼ŒStream æ˜¯å·²è¢«é‡‡ç”¨çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>æœ¬æŒ‡å—çš„ç›®çš„æ˜¯è¿›ä¸€æ­¥è¯¦ç»†è¯´æ˜èƒŒå‹æ˜¯ä»€ä¹ˆï¼Œä»¥åŠæµå¦‚ä½•åœ¨Node.jsçš„æºä»£ç ä¸­è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æœ¬æŒ‡å—çš„ç¬¬äºŒéƒ¨åˆ†å°†ä»‹ç»å»ºè®®çš„æœ€ä½³å®è·µï¼Œä»¥ç¡®ä¿æ‚¨çš„åº”ç”¨ç¨‹åºçš„ä»£ç åœ¨å®ç°æµæ—¶å®‰å…¨å’Œä¼˜åŒ–ã€‚</p>
<p>æˆ‘ä»¬å‡è®¾èº«ä¸ºè¯»è€…çš„ä½ å¯¹ Node.js ä¸­èƒŒå‹ï¼Œ<code class="language-text">Buffer</code> å’Œ <code class="language-text">EventEmitters</code> çš„ä¸€èˆ¬å®šä¹‰ä»¥åŠ Stream çš„ä¸€äº›ç»éªŒæœ‰ç‚¹ç†Ÿæ‚‰ã€‚å¦‚æœæ‚¨è¿˜æ²¡æœ‰é˜…è¯»è¿™äº›æ–‡æ¡£ï¼Œé¦–å…ˆæŸ¥çœ‹APIæ–‡æ¡£å¹¶ä¸æ˜¯ä¸€ä¸ªåä¸»æ„ï¼Œå› ä¸ºè¿™å°†æœ‰åŠ©äºåœ¨é˜…è¯»æœ¬æŒ‡å—æ—¶æ‰©å±•æ‚¨çš„ç†è§£ã€‚</p>
<h2>æ•°æ®å¤„ç†çš„é—®é¢˜</h2>
<p>åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œæ•°æ®é€šè¿‡ç®¡é“ï¼Œå¥—æ¥å­—å’Œä¿¡å·(pipes, sockets, and signals)ä»ä¸€ä¸ªè¿›ç¨‹ä¼ è¾“åˆ°å¦ä¸€ä¸ªè¿›ç¨‹ã€‚åœ¨ Node.js ä¸­ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†ä¸€ä¸ªåä¸º Stream çš„ç±»ä¼¼æœºåˆ¶ã€‚Stream å¾ˆæ£’ï¼ä»–ä»¬ä¸º Node.js åšäº†å¾ˆå¤šå·¥ä½œï¼Œå‡ ä¹å†…éƒ¨ä»£ç åº“çš„æ¯ä¸ªéƒ¨åˆ†éƒ½åˆ©ç”¨è¯¥æ¨¡å—ã€‚ä½œä¸ºä¸€åå¼€å‘äººå‘˜ï¼Œé¼“åŠ±æ‚¨å»ä½¿ç”¨å®ƒä»¬ï¼</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> readline <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'readline'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// process.stdin and process.stdout are both instances of Streams</span>
<span class="token keyword">const</span> rl <span class="token operator">=</span> readline<span class="token punctuation">.</span><span class="token function">createInterface</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  input<span class="token operator">:</span> process<span class="token punctuation">.</span>stdin<span class="token punctuation">,</span>
  output<span class="token operator">:</span> process<span class="token punctuation">.</span>stdout
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

rl<span class="token punctuation">.</span><span class="token function">question</span><span class="token punctuation">(</span><span class="token string">'Why should you use streams? '</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">answer</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Maybe it's </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>answer<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, maybe it's because they are awesome! :)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  rl<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>é€šè¿‡æ¯”è¾ƒ Node.js Stream å®ç°çš„å†…éƒ¨ç³»ç»Ÿå·¥å…·ï¼Œå¯ä»¥è¯æ˜ä¸ºä»€ä¹ˆé€šè¿‡ <strong>Stream</strong> å®ç° <strong>backpressure</strong> æœºåˆ¶æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¼˜åŒ–ã€‚</p>
<p>åœ¨ä¸€ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†é‡‡ç”¨å¤§æ–‡ä»¶(å¤§çº¦9GB) å¹¶ä½¿ç”¨ç†Ÿæ‚‰çš„<code class="language-text">zip(1)</code>å·¥å…·å¯¹å…¶è¿›è¡Œå‹ç¼©ã€‚</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">$ zip The.Matrix.1080p.mkv</code></pre></div>
<p>è™½ç„¶è¿™éœ€è¦å‡ åˆ†é’Ÿçš„æ—¶é—´æ‰èƒ½å®Œæˆï¼Œåœ¨å¦ä¸€ä¸ªshellä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œä¸€ä¸ªé‡‡ç”¨ Node.js çš„æ¨¡å— <code class="language-text">zlib</code> çš„è„šæœ¬ï¼Œè¯¥è„šæœ¬åŒ…å«å¦ä¸€ä¸ªå‹ç¼©å·¥å…· <code class="language-text">gzip(1)</code>ã€‚</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> gzip <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'zlib'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createGzip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> inp <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token string">'The.Matrix.1080p.mkv'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> out <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'The.Matrix.1080p.mkv.gz'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

inp<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gzip<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>ç„¶åæ¥éªŒè¯ç»“æœï¼Œå°è¯•æ‰“å¼€æ¯ä¸ªå‹ç¼©æ–‡ä»¶ã€‚ç”± <code class="language-text">zip(1)</code> å·¥å…·å‹ç¼©çš„æ–‡ä»¶å°†é€šçŸ¥æ‚¨æ–‡ä»¶å·²æŸåï¼Œè€Œç”± Stream å®Œæˆçš„å‹ç¼©å°†æ— é”™åœ°è§£å‹ç¼©ã€‚</p>
<p>æ³¨æ„ï¼šåœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code class="language-text">.pipe()</code> ä»ä¸€ç«¯åˆ°å¦ä¸€ç«¯è·å–æ•°æ®æºã€‚ä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œæ²¡æœ‰é™„åŠ é€‚å½“çš„é”™è¯¯å¤„ç†ç¨‹åºã€‚å¦‚æœå¤§é‡æ•°æ®æ— æ³•æ­£ç¡®æ¥æ”¶ï¼Œåˆ™å¯è¯»æºæˆ– <code class="language-text">gzip</code> æµä¸ä¼šè¢«é”€æ¯ã€‚<code class="language-text">.pump</code> æ˜¯ä¸€ä¸ªå¾ˆå®ç”¨å·¥å…·ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªå¤±è´¥æˆ–å…³é—­ï¼Œå®ƒå°†ç¨³å®šæ— è¯¯åœ°é”€æ¯ç®¡é“ä¸­çš„æ‰€æœ‰æµï¼Œå¹¶ä¸”åœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯å¿…é¡»çš„ï¼</p>
<h2>æ•°æ®å¤ªå¤š, å¤ªå¿«</h2>
<p>æœ‰äº›æƒ…å†µä¸‹ï¼Œå¯è¯»æµå¯èƒ½å¤ªå¿«åœ°å°†æ•°æ®æä¾›ç»™<code class="language-text">Writable</code> - è¿œè¿œè¶…è¿‡æ¶ˆè´¹è€…å¯ä»¥å¤„ç†çš„æ•°é‡ï¼</p>
<p>å½“å‘ç”Ÿè¿™ç§æƒ…å†µæ—¶ï¼Œæ¶ˆè´¹è€…å°†å¼€å§‹æ’åˆ—æ‰€æœ‰æ•°æ®å—ä»¥ä¾›ä»¥åä½¿ç”¨ã€‚å†™å…¥é˜Ÿåˆ—å°†å˜å¾—è¶Šæ¥è¶Šé•¿ï¼Œå¹¶ä¸”å› ä¸ºè¿™ä¸ªæ›´å¤šçš„æ•°æ®å¿…é¡»ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œç›´åˆ°æ•´ä¸ªè¿‡ç¨‹å®Œæˆã€‚</p>
<p>å†™å…¥ç£ç›˜æ¯”ä»ç£ç›˜è¯»å–è¦æ…¢å¾ˆå¤šï¼Œå› æ­¤ï¼Œå½“æˆ‘ä»¬è¯•å›¾å‹ç¼©æ–‡ä»¶å¹¶å°†å…¶å†™å…¥ç¡¬ç›˜æ—¶ï¼Œå°±ä¼šå‘ç”ŸèƒŒå‹ï¼Œå› ä¸ºå†™å…¥ç£ç›˜å°†æ— æ³•è·Ÿä¸Šé€Ÿåº¦é˜…è¯»ã€‚</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// Secretly the stream is saying: "whoa, whoa! hang on, this is way too much!"</span>
<span class="token comment">// Data will begin to build up on the read-side of the data buffer as</span>
<span class="token comment">// `write` tries to keep up with the incoming data flow.</span>
inp<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gzip<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>outputFile<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>è¿™å°±æ˜¯èƒŒå‹æœºåˆ¶å¾ˆé‡è¦çš„åŸå› ã€‚å¦‚æœèƒŒå‹ç³»ç»Ÿä¸å­˜åœ¨ï¼Œè¿™ä¸ªè¿‡ç¨‹å°†è€—å°½ç³»ç»Ÿçš„å†…å­˜ï¼Œä¸¥é‡å‡ç¼“å…¶ä»–çš„è¿‡ç¨‹ï¼Œå¹¶å„æ–­å¤§éƒ¨åˆ†ç³»ç»Ÿèµ„æºç›´åˆ°å®Œæˆã€‚</p>
<p>ç»“å±€å¦‚ä¸‹:</p>
<ul>
<li>æ”¾æ…¢æ‰€æœ‰å…¶ä»–ç°æœ‰æµç¨‹</li>
<li>ä¸€ä¸ªéå¸¸åŠ³ç´¯è¿‡åº¦çš„åƒåœ¾æ”¶é›†å™¨</li>
<li>å†…å­˜è€—å°½</li>
</ul>
<p>åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†å–å‡º<code class="language-text">.write()</code> å‡½æ•°çš„è¿”å›å€¼å¹¶å°†å…¶æ›´æ”¹ä¸º trueï¼Œè¿™æœ‰æ•ˆåœ°ç¦ç”¨äº†Node.jså†…æ ¸ä¸­çš„èƒŒå‹æ”¯æŒã€‚åœ¨ä»»ä½•å¯¹â€œä¿®æ”¹â€äºŒè¿›åˆ¶æ–‡ä»¶çš„å¼•ç”¨ä¸­ï¼Œæˆ‘ä»¬éƒ½åœ¨è®¨è®ºå¦‚ä½•è¿è¡Œæ²¡æœ‰ <code class="language-text">return ret;</code> çš„èŠ‚ç‚¹äºŒè¿›åˆ¶ (node binary) æ–‡ä»¶çº¿ï¼Œè€Œæ›¿æ¢ä¸º <code class="language-text">return true</code> ;</p>
<h2>è¿‡é‡çš„åƒåœ¾æ”¶é›†</h2>
<p>è®©æˆ‘ä»¬çœ‹çœ‹ä¸€ä¸ªå¿«é€Ÿçš„åŸºå‡†ã€‚ä½¿ç”¨ä¸Šé¢çš„åŒä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬è¿›è¡Œäº†å‡ æ¬¡è¯•éªŒï¼Œä»¥è·å¾—ä¸¤ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„ä¸­ä½æ—¶é—´ã€‚</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">   trial (#)  | `node` binary (ms) | modified `node` binary (ms)
=================================================================
      1       |      56924         |           55011
      2       |      52686         |           55869
      3       |      59479         |           54043
      4       |      54473         |           55229
      5       |      52933         |           59723
=================================================================
average time: |      55299         |           55975</code></pre></div>
<p>ä¸¤è€…éƒ½èŠ±è´¹ä¸€åˆ†é’Ÿå·¦å³çš„æ—¶é—´ï¼Œæ‰€ä»¥æ ¹æœ¬æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œä½†è®©æˆ‘ä»¬ä»”ç»†è§‚å¯Ÿä¸€ä¸‹ï¼Œä»¥ç¡®è®¤æˆ‘ä»¬çš„çŒœæµ‹æ˜¯å¦æ­£ç¡®ã€‚æˆ‘ä»¬ä½¿ç”¨ Linux å·¥å…· <code class="language-text">dtrace</code> æ¥è¯„ä¼°V8åƒåœ¾æ”¶é›†å™¨çš„æƒ…å†µã€‚</p>
<p>GCï¼ˆåƒåœ¾å›æ”¶å™¨ï¼‰æµ‹é‡çš„æ—¶é—´è¡¨ç¤ºåƒåœ¾æ”¶é›†å™¨å®Œæˆçš„å•æ¬¡æ‰«æçš„å®Œæ•´å‘¨æœŸçš„æ—¶é—´é—´éš”ï¼š</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">approx. time (ms) | GC (ms) | modified GC (ms)
=================================================
          0       |    0    |      0
          1       |    0    |      0
         40       |    0    |      2
        170       |    3    |      1
        300       |    3    |      1

         *             *           *
         *             *           *
         *             *           *

      39000       |    6    |     26
      42000       |    6    |     21
      47000       |    5    |     32
      50000       |    8    |     28
      54000       |    6    |     35</code></pre></div>
<p>è™½ç„¶è¿™ä¸¤ç§æ–¹æ³•çš„èµ·å§‹æ—¶é—´ç›¸åŒï¼Œå¹¶ä¸”ä¼¼ä¹ä»¥ç›¸åŒçš„é€Ÿåº¦å·¥ä½œï¼Œä½†æ˜¾ç„¶åœ¨å‡ ç§’é’Ÿåä½¿ç”¨æ­£ç¡®å·¥ä½œçš„åå‹ç³»ç»ŸGCè´Ÿè·ä¼šä»¥4-8æ¯«ç§’çš„é—´éš”æŒç»­æ‰©æ•£ï¼Œç›´åˆ°æ•°æ®ä¼ è¾“ç»“æŸã€‚</p>
<p>ä½†æ˜¯ï¼Œå½“èƒŒå‹ç³»ç»Ÿä¸åœ¨æ—¶ï¼ŒV8åƒåœ¾å›æ”¶ç³»ç»Ÿå¼€å§‹æ‹–å»¶ã€‚æ­£å¸¸çš„äºŒè¿›åˆ¶æ–‡ä»¶åœ¨ä¸€åˆ†é’Ÿå†…è°ƒç”¨GCçº¦75æ¬¡ï¼Œè€Œä¿®æ”¹åçš„äºŒè¿›åˆ¶æ–‡ä»¶åªè§¦å‘36æ¬¡ã€‚</p>
<p>è¿™æ˜¯ç”±äºè®°å¿†ä½“ä½¿ç”¨é‡å¢åŠ è€Œç´¯ç§¯çš„ç¼“æ…¢è€Œæ¸è¿›çš„å€ºåŠ¡ã€‚éšç€æ•°æ®çš„ä¼ è¾“ï¼Œå¦‚æœæ²¡æœ‰èƒŒå‹ç³»ç»Ÿï¼Œæ¯ä¸ªå—ä¼ è¾“éƒ½ä¼šä½¿ç”¨æ›´å¤šçš„å†…å­˜ã€‚</p>
<p>åˆ†é…çš„å†…å­˜è¶Šå¤šï¼ŒGCå°±å¿…é¡»åœ¨ä¸€æ¬¡æ‰«æä¸­å¤„ç†å¾—è¶Šå¤šã€‚æ‰«æè¶Šå¤§ï¼ŒGCéœ€è¦å†³å®šä»€ä¹ˆå¯ä»¥é‡Šæ”¾ï¼Œå¹¶ä¸”åœ¨æ›´å¤§çš„å†…å­˜ç©ºé—´ä¸­æ‰«æåˆ†ç¦»çš„æŒ‡é’ˆä¼šæ¶ˆè€—æ›´å¤šçš„è®¡ç®—èƒ½åŠ›ã€‚</p>
<h2>å†…å­˜è€—å°½</h2>
<p>ä¸ºäº†ç¡®å®šæ¯ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„å†…å­˜æ¶ˆè€—ï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸ªè¿›ç¨‹åˆ†åˆ«è®¾å®šäº†<code class="language-text">/usr/bin/time -lp sudo ./node ./backpressure-example/zlib.js</code>ã€‚</p>
<p>è¿™æ˜¯æ­£å¸¸äºŒè¿›åˆ¶çš„è¾“å‡ºï¼š</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">Respecting the return value of .write()
=============================================
real        58.88
user        56.79
sys          8.79
  87810048  maximum resident set size
         0  average shared memory size
         0  average unshared data size
         0  average unshared stack size
     19427  page reclaims
      3134  page faults
         0  swaps
         5  block input operations
       194  block output operations
         0  messages sent
         0  messages received
         1  signals received
        12  voluntary context switches
    666037  involuntary context switches</code></pre></div>
<p>è™šæ‹Ÿå†…å­˜å ç”¨çš„æœ€å¤§å­—èŠ‚å¤§å°çº¦ä¸º87.81 mbã€‚ ç°åœ¨æ”¹å˜ <code class="language-text">.write()</code> å‡½æ•°çš„è¿”å›å€¼ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">Without respecting the return value of .write():
==================================================
real        54.48
user        53.15
sys          7.43
1524965376  maximum resident set size
         0  average shared memory size
         0  average unshared data size
         0  average unshared stack size
    373617  page reclaims
      3139  page faults
         0  swaps
        18  block input operations
       199  block output operations
         0  messages sent
         0  messages received
         1  signals received
        25  voluntary context switches
    629566  involuntary context switches</code></pre></div>
<p>è™šæ‹Ÿå†…å­˜å ç”¨çš„æœ€å¤§å­—èŠ‚å¤§å°çº¦ä¸º1.52 gbã€‚</p>
<p>å¦‚æœæ²¡æœ‰é€‚å½“çš„ Stream backpressureï¼Œåˆ†é…çš„å†…å­˜ç©ºé—´å°±ä¼šå¢åŠ ä¸€ä¸ªæ•°é‡çº§ - è¿™æ˜¯åŒä¸€è¿‡ç¨‹ä¹‹é—´çš„å·¨å¤§å·®å¼‚ï¼</p>
<p>è¿™ä¸ªå®éªŒå±•ç¤ºäº† Node.js çš„èƒŒå‹æœºåˆ¶æ˜¯å¦‚ä½•é’ˆå¯¹æ‚¨çš„è®¡ç®—ç³»ç»Ÿä¼˜åŒ–å’Œå…·æœ‰æˆæœ¬æ•ˆç›Šçš„ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬åˆ†æä¸€ä¸‹å®ƒçš„å·¥ä½œåŸç†ï¼</p>
<h2>èƒŒå‹æ˜¯å¦‚ä½•è§£å†³è¿™äº›é—®é¢˜çš„?</h2>
<p>æœ‰ä¸åŒçš„åŠŸèƒ½å°†æ•°æ®ä»ä¸€ä¸ªè¿›ç¨‹ä¼ è¾“åˆ°å¦ä¸€ä¸ªè¿›ç¨‹ã€‚åœ¨Node.jsä¸­ï¼Œæœ‰ä¸€ä¸ªåä¸º<code class="language-text">.pipe()</code>çš„å†…éƒ¨å†…ç½®å‡½æ•°ã€‚è¿˜æœ‰å…¶ä»–çš„è½¯ä»¶åŒ…ä¹Ÿå¯ä»¥ä½¿ç”¨ï¼ä½†æœ€ç»ˆï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹çš„åŸºæœ¬å±‚é¢ä¸Šï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªç‹¬ç«‹çš„ç»„ä»¶ï¼šæ•°æ®æºå’Œæ¶ˆè´¹è€…ã€‚</p>
<p>å½“ä»æºè°ƒç”¨<code class="language-text">.pipe()</code>æ—¶ï¼Œå®ƒå‘æ¶ˆè´¹è€…å‘å‡ºä¿¡å·ï¼Œå‘ŠçŸ¥æœ‰æ•°æ®è¦ä¼ è¾“ã€‚ç®¡é“åŠŸèƒ½æœ‰åŠ©äºä¸ºäº‹ä»¶è§¦å‘å™¨è®¾ç½®é€‚å½“çš„èƒŒå‹é—­åˆã€‚</p>
<p>åœ¨Node.jsä¸­ï¼Œæºæ˜¯å¯è¯»æµï¼Œè€Œæ¶ˆè´¹è€…æ˜¯å¯å†™æµï¼ˆè¿™ä¸¤è€…å¯ä»¥ä¸åŒå·¥æˆ–è½¬æ¢æµäº’æ¢ï¼Œä½†å¯¹äºæœ¬æŒ‡å—è€Œè¨€ï¼Œè¿™æ˜¯è¶…å‡ºèŒƒå›´çš„ï¼‰ã€‚</p>
<p>è§¦å‘èƒŒå‹çš„æ—¶åˆ»å¯ä»¥ç²¾ç¡®åœ°ç¼©å°åˆ°Writableçš„<code class="language-text">.write()</code>å‡½æ•°çš„è¿”å›å€¼ã€‚å½“ç„¶ï¼Œè¿™ä¸ªè¿”å›å€¼ç”±å‡ ä¸ªæ¡ä»¶å†³å®šã€‚</p>
<p>åœ¨æ•°æ®ç¼“å†²åŒºå·²è¶…è¿‡<code class="language-text">highWaterMark</code>æˆ–å†™å…¥é˜Ÿåˆ—å½“å‰æ­£å¿™çš„ä»»ä½•æƒ…å†µä¸‹ï¼Œ<code class="language-text">.write()</code>å°†è¿”å›<code class="language-text">false</code>ã€‚</p>
<p>å½“è¿”å›é”™è¯¯å€¼æ—¶ï¼ŒèƒŒå‹ç³»ç»Ÿå¯åŠ¨ã€‚å®ƒå°†æš‚åœä¼ å…¥çš„å¯è¯»æµå‘é€ä»»ä½•æ•°æ®å¹¶ç­‰å¾…æ¶ˆè´¹è€…å†æ¬¡å‡†å¤‡å°±ç»ªã€‚æ¸…ç©ºæ•°æ®ç¼“å†²åŒºåï¼Œå°†å‘å‡º<code class="language-text">.drain()</code>äº‹ä»¶å¹¶æ¢å¤ä¼ å…¥çš„æ•°æ®æµã€‚</p>
<p>é˜Ÿåˆ—å®Œæˆåï¼ŒèƒŒå‹å°†å…è®¸å†æ¬¡å‘é€æ•°æ®ã€‚æ­£åœ¨ä½¿ç”¨çš„å†…å­˜ç©ºé—´å°†è‡ªè¡Œé‡Šæ”¾å¹¶ä¸ºä¸‹ä¸€æ‰¹æ•°æ®åšå¥½å‡†å¤‡ã€‚</p>
<p>è¿™æœ‰æ•ˆåœ°å…è®¸åœ¨ä»»ä½•ç»™å®šæ—¶é—´ä¸º<code class="language-text">.pipe()</code>å‡½æ•°ä½¿ç”¨å›ºå®šæ•°é‡çš„å†…å­˜ã€‚æ²¡æœ‰å†…å­˜æ³„æ¼ï¼Œæ²¡æœ‰æ— é™ç¼“å†²ï¼Œåƒåœ¾æ”¶é›†å™¨åªéœ€è¦å¤„ç†å†…å­˜ä¸­çš„ä¸€ä¸ªåŒºåŸŸï¼</p>
<p>é‚£ä¹ˆï¼Œå¦‚æœèƒŒå‹å¦‚æ­¤é‡è¦ï¼Œä¸ºä»€ä¹ˆä½ ï¼ˆå¯èƒ½ï¼‰æ²¡æœ‰å¬è¯´è¿‡å®ƒï¼Ÿé‚£ä¹ˆç­”æ¡ˆå¾ˆç®€å•ï¼šNode.jsè‡ªåŠ¨å®Œæˆæ‰€æœ‰è¿™äº›ã€‚</p>
<p>å¤ªæ£’äº†ï¼ä½†æ˜¯å½“æˆ‘ä»¬è¯•å›¾ç†è§£å¦‚ä½•å®ç°æˆ‘ä»¬è‡ªå·±çš„è‡ªå®šä¹‰æµæ—¶ä¹Ÿä¸æ˜¯é‚£ä¹ˆå¥½ã€‚</p>
<p>æ³¨æ„ï¼šåœ¨å¤§å¤šæ•°æœºå™¨ä¸­ï¼Œæœ‰ä¸€ä¸ªå­—èŠ‚å¤§å°å†³å®šç¼“å†²åŒºä½•æ—¶å·²æ»¡ï¼ˆè¿™å°†åœ¨ä¸åŒçš„æœºå™¨ä¸Šæœ‰æ‰€ä¸åŒï¼‰ã€‚ Node.jså…è®¸æ‚¨è®¾ç½®è‡ªå·±çš„è‡ªå®šä¹‰highWaterMarkï¼Œä½†é€šå¸¸ï¼Œé»˜è®¤è®¾ç½®ä¸º16kbï¼ˆå¯¹äºobjectModeæµï¼Œä¸º16384æˆ–16ï¼‰ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ‚¨å¯èƒ½éœ€è¦æé«˜è¯¥å€¼ï¼Œä½†è¯·è°¨æ…è¡Œäº‹ï¼</p>
<h2><code class="language-text">.pipe()</code>çš„ç”Ÿå‘½å‘¨æœŸ</h2>
<p>ä¸ºäº†æ›´å¥½åœ°ç†è§£èƒŒå‹ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªå¯è¯»æµçš„ç”Ÿå‘½å‘¨æœŸçš„æµç¨‹å›¾ï¼Œè¯¥æµè¢«å¯¼å…¥åˆ°å¯å†™æµä¸­ï¼š</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">                                                     +===================+
                         x--&gt;  Piping functions   +--&gt;   src.pipe(dest)  |
                         x     are set up during     |===================|
                         x     the .pipe method.     |  Event callbacks  |
  +===============+      x                           |-------------------|
  |   Your Data   |      x     They exist outside    | .on(&#39;close&#39;, cb)  |
  +=======+=======+      x     the data flow, but    | .on(&#39;data&#39;, cb)   |
          |              x     importantly attach    | .on(&#39;drain&#39;, cb)  |
          |              x     events, and their     | .on(&#39;unpipe&#39;, cb) |
+---------v---------+    x     respective callbacks. | .on(&#39;error&#39;, cb)  |
|  Readable Stream  +----+                           | .on(&#39;finish&#39;, cb) |
+-^-------^-------^-+    |                           | .on(&#39;end&#39;, cb)    |
  ^       |       ^      |                           +-------------------+
  |       |       |      |
  |       ^       |      |
  ^       ^       ^      |    +-------------------+         +=================+
  ^       |       ^      +----&gt;  Writable Stream  +---------&gt;  .write(chunk)  |
  |       |       |           +-------------------+         +=======+=========+
  |       |       |                                                 |
  |       ^       |                              +------------------v---------+
  ^       |       +-&gt; if (!chunk)                |    Is this chunk too big?  |
  ^       |       |     emit .end();             |    Is the queue busy?      |
  |       |       +-&gt; else                       +-------+----------------+---+
  |       ^       |     emit .write();                   |                |
  |       ^       ^                                   +--v---+        +---v---+
  |       |       ^-----------------------------------&lt;  No  |        |  Yes  |
  ^       |                                           +------+        +---v---+
  ^       |                                                               |
  |       ^               emit .pause();          +=================+     |
  |       ^---------------^-----------------------+  return false;  &lt;-----+---+
  |                                               +=================+         |
  |                                                                           |
  ^            when queue is empty     +============+                         |
  ^------------^-----------------------&lt;  Buffering |                         |
               |                       |============|                         |
               +&gt; emit .drain();       |  ^Buffer^  |                         |
               +&gt; emit .resume();      +------------+                         |
                                       |  ^Buffer^  |                         |
                                       +------------+   add chunk to queue    |
                                       |            &lt;---^---------------------&lt;
                                       +============+</code></pre></div>
<p>æ³¨æ„ï¼šå¦‚æœæ‚¨æ­£åœ¨è®¾ç½®ä¸€ä¸ªç®¡é“ä»¥å°†å‡ ä¸ªæµé“¾æ¥åœ¨ä¸€èµ·æ¥æ“çºµæ•°æ®ï¼Œé‚£ä¹ˆæ‚¨å¾ˆå¯èƒ½ä¼šå®ç°Transformæµã€‚</p>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¥è‡ªå¯è¯»æµçš„è¾“å‡ºå°†è¾“å…¥åˆ°Transformä¸­ï¼Œå¹¶å°†æµå…¥Writableã€‚</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">Readable.pipe(Transformable).pipe(Writable);</code></pre></div>
<p>èƒŒå‹å°†è‡ªåŠ¨åº”ç”¨ï¼Œä½†è¯·æ³¨æ„è½¬æ¢æµçš„è¾“å…¥å’Œè¾“å‡º<code class="language-text">highWaterMark</code>å¯èƒ½ä¼šè¢«æ“çºµï¼Œå¹¶ä¼šå½±å“åå‹ç³»ç»Ÿã€‚</p>
<h2>èƒŒå‹æŒ‡å—</h2>
<p>ç”±äºNode.js v0.10ï¼ŒStreamç±»æä¾›äº†ä½¿ç”¨è¿™äº›å‡½æ•°ï¼ˆ<code class="language-text">._read()å’Œ._write()</code>ï¼‰çš„ä¸‹åˆ’çº¿ç‰ˆæœ¬æ¥ä¿®æ”¹<code class="language-text">.read()</code>æˆ–<code class="language-text">.write()</code>çš„è¡Œä¸ºçš„åŠŸèƒ½ã€‚ ã€‚</p>
<p>æœ‰å…³äºå®ç°å¯è¯»æµå’Œå®ç°å¯å†™æµçš„æŒ‡å¯¼æ–‡ä»¶ã€‚æˆ‘ä»¬å‡è®¾ä½ å·²ç»é˜…è¯»äº†è¿™äº›å†…å®¹ï¼Œä¸‹ä¸€èŠ‚å°†æ›´æ·±å…¥ä¸€ç‚¹ã€‚</p>
<h2>å®ç°è‡ªå®šä¹‰æµæ—¶éµå®ˆçš„è§„åˆ™</h2>
<p><code class="language-text">Stream</code>çš„é»„é‡‘æ³•åˆ™æ˜¯å§‹ç»ˆå°Šé‡èƒŒå‹ã€‚æœ€ä½³å®è·µçš„æ„æˆæ˜¯éçŸ›ç›¾çš„åšæ³•ã€‚åªè¦ä½ å°å¿ƒé¿å…ä¸å†…éƒ¨èƒŒå‹æ”¯æŒç›¸å†²çªçš„è¡Œä¸ºï¼Œå°±å¯ä»¥ç¡®å®šä½ æ­£åœ¨éµå¾ªè‰¯å¥½çš„åšæ³•ã€‚</p>
<p>ä¸€èˆ¬æ¥è¯´:</p>
<ol>
<li>å¦‚æœæ²¡æœ‰è¯¢é—®ï¼Œè¯·ä¸è¦ä½¿ç”¨<code class="language-text">.push()</code>ã€‚</li>
<li>æ°¸è¿œä¸è¦åœ¨è¿”å›falseåè°ƒç”¨<code class="language-text">.write()</code>ï¼Œè€Œæ˜¯ç­‰å¾…â€™drainâ€™ã€‚</li>
<li>Streamsåœ¨ä¸åŒçš„Node.jsç‰ˆæœ¬å’Œæ‚¨ä½¿ç”¨çš„åº“ä¹‹é—´è¿›è¡Œæ›´æ”¹ã€‚è¦å°å¿ƒæ³¨æ„å¹¶æµ‹è¯•ä¸€ä¸‹ã€‚</li>
</ol>
<p>æ³¨æ„ï¼šå…³äºç¬¬3ç‚¹ï¼Œæ„å»ºæµè§ˆå™¨æµçš„éå¸¸æœ‰ç”¨çš„åŒ…æ˜¯<code class="language-text">readable-stream</code>ã€‚ Rodd Vaggæ’°å†™äº†ä¸€ç¯‡å¾ˆæ£’çš„åšå®¢æ–‡ç« ï¼Œæè¿°äº†è¿™ä¸ªåº“çš„å®ç”¨æ€§ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå®ƒä¸ºå¯è¯»æµæä¾›äº†ä¸€ç§è‡ªåŠ¨ä¼˜é›…é™çº§ï¼Œå¹¶æ”¯æŒæ—§ç‰ˆæœ¬çš„æµè§ˆå™¨å’ŒNode.js.</p>
<h2>å¯è¯»æµçš„ç‰¹å®šè§„åˆ™</h2>
<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»äº†è§£äº†<code class="language-text">.write()</code>å¦‚ä½•å½±å“èƒŒå‹ï¼Œå¹¶å°†é‡ç‚¹æ”¾åœ¨<code class="language-text">Writable</code>æµä¸Šã€‚ç”±äºNode.jsçš„åŠŸèƒ½ï¼Œæ•°æ®åœ¨æŠ€æœ¯ä¸Šä»å¯è¯»æµå‘ä¸‹æ¸¸æµå‘å¯å†™ã€‚ä½†æ˜¯ï¼Œæ­£å¦‚æˆ‘ä»¬å¯ä»¥åœ¨æ•°æ®ï¼Œç‰©è´¨æˆ–èƒ½é‡çš„ä»»ä½•ä¼ è¾“ä¸­è§‚å¯Ÿåˆ°çš„é‚£æ ·ï¼Œæºä¸ç›®æ ‡ä¸€æ ·é‡è¦ï¼Œå¯è¯»æµå¯¹äºå¦‚ä½•å¤„ç†èƒŒå‹è‡³å…³é‡è¦ã€‚</p>
<p>è¿™ä¸¤ä¸ªè¿›ç¨‹éƒ½ä¾èµ–äºå¦ä¸€ä¸ªè¿›è¡Œæœ‰æ•ˆçš„é€šä¿¡ï¼Œå¦‚æœ<code class="language-text">Readable</code>å¿½ç•¥äº†å½“<code class="language-text">Writable</code>æµè¦æ±‚å®ƒåœæ­¢å‘é€æ•°æ®æ—¶ï¼Œå®ƒå¯èƒ½ä¸<code class="language-text">.write()</code>çš„è¿”å›å€¼ä¸æ­£ç¡®æ—¶ä¸€æ ·æœ‰é—®é¢˜ã€‚</p>
<p>å› æ­¤ï¼Œåœ¨å°Šé‡<code class="language-text">.write()</code>è¿”å›æ—¶ï¼Œæˆ‘ä»¬è¿˜å¿…é¡»å°Šé‡<code class="language-text">._read()</code>æ–¹æ³•ä¸­ä½¿ç”¨çš„<code class="language-text">.push()</code>çš„è¿”å›å€¼ã€‚å¦‚æœ<code class="language-text">.push()</code>è¿”å›ä¸€ä¸ªå‡å€¼ï¼Œåˆ™è¯¥æµå°†åœæ­¢ä»æºè¯»å–ã€‚å¦åˆ™ï¼Œå®ƒå°†ç»§ç»­è€Œä¸ä¼šæš‚åœã€‚</p>
<p>è¿™æœ‰ä¸ªä½¿ç”¨<code class="language-text">.push()</code>çš„åä¾‹</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">// This is problematic as it completely ignores return value from push
// which may be a signal for backpressure from the destination stream!
class MyReadable extends Readable {
  _read(size) {
    let chunk;
    while (null !== (chunk = getNextChunk())) {
      this.push(chunk);
    }
  }
}</code></pre></div>
<p>å¦å¤–ï¼Œä»å®šåˆ¶æµçš„å¤–éƒ¨æ¥çœ‹ï¼Œå¿½è§†èƒŒå‹æ˜¯éå¸¸é‡è¦çš„ã€‚åœ¨è¿™ä¸ªè‰¯å¥½å®è·µçš„åä¾‹ä¸­ï¼Œåº”ç”¨ç¨‹åºçš„ä»£ç åœ¨æ•°æ®å¯ç”¨æ—¶å¼ºåˆ¶æ•°æ®ï¼ˆç”±<code class="language-text">.data</code>äº‹ä»¶å‘é€ä¿¡å·ï¼‰ï¼š</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">// This ignores the backpressure mechanisms Node.js has set in place,
// and unconditionally pushes through data, regardless if the
// destination stream is ready for it or not.
readable.on(&#39;data&#39;, (data) =&gt;
  writable.write(data)
);</code></pre></div>
<h2>å¯å†™æµçš„ç‰¹å®šè§„åˆ™</h2>
<p>å›æƒ³ä¸€ä¸‹<code class="language-text">.write()</code>å¯èƒ½ä¼šæ ¹æ®æŸäº›æ¡ä»¶è¿”å›trueæˆ–falseã€‚å¹¸è¿çš„æ˜¯ï¼Œåœ¨æ„å»ºæˆ‘ä»¬è‡ªå·±çš„å¯å†™æµæ—¶ï¼ŒæµçŠ¶æ€æœºå°†å¤„ç†æˆ‘ä»¬çš„å›è°ƒå¹¶ç¡®å®šä½•æ—¶å¤„ç†èƒŒå‹å¹¶ä¸ºæˆ‘ä»¬ä¼˜åŒ–æ•°æ®æµã€‚</p>
<p>ä½†æ˜¯ï¼Œå½“æˆ‘ä»¬æƒ³ç›´æ¥ä½¿ç”¨Writableæ—¶ï¼Œæˆ‘ä»¬å¿…é¡»å°Šé‡<code class="language-text">.write()</code>è¿”å›å€¼å¹¶å¯†åˆ‡æ³¨æ„è¿™äº›æ¡ä»¶ï¼š</p>
<ul>
<li>å¦‚æœå†™é˜Ÿåˆ—å¿™ï¼Œ.<code class="language-text">write()</code>å°†è¿”å›falseã€‚</li>
<li>å¦‚æœæ•°æ®å—å¤ªå¤§ï¼Œ<code class="language-text">.write()</code>å°†è¿”å›falseï¼ˆè¯¥å€¼ç”±å˜é‡highWaterMarkæŒ‡ç¤ºï¼‰ã€‚</li>
</ul>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">// This writable is invalid because of the async nature of JavaScript callbacks.
// Without a return statement for each callback prior to the last,
// there is a great chance multiple callbacks will be called.
class MyWritable extends Writable {
  _write(chunk, encoding, callback) {
    if (chunk.toString().indexOf(&#39;a&#39;) &gt;= 0)
      callback();
    else if (chunk.toString().indexOf(&#39;b&#39;) &gt;= 0)
      callback();
    callback();
  }
}

// The proper way to write this would be:
    if (chunk.contains(&#39;a&#39;))
      return callback();
    else if (chunk.contains(&#39;b&#39;))
      return callback();
    callback();</code></pre></div>
<p>åœ¨å®ç°<code class="language-text">._writev()</code>æ—¶è¿˜éœ€è¦æ³¨æ„ä¸€äº›äº‹é¡¹ã€‚è¯¥å‡½æ•°ä¸<code class="language-text">.cork()</code>ç»“åˆä½¿ç”¨ï¼Œä½†å†™å…¥æ—¶å¸¸è§é”™è¯¯ï¼š</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">// Using .uncork() twice here makes two calls on the C++ layer, rendering the
// cork/uncork technique useless.
ws.cork();
ws.write(&#39;hello &#39;);
ws.write(&#39;world &#39;);
ws.uncork();

ws.cork();
ws.write(&#39;from &#39;);
ws.write(&#39;Matteo&#39;);
ws.uncork();

// The correct way to write this is to utilize process.nextTick(), which fires
// on the next event loop.
ws.cork();
ws.write(&#39;hello &#39;);
ws.write(&#39;world &#39;);
process.nextTick(doUncork, ws);

ws.cork();
ws.write(&#39;from &#39;);
ws.write(&#39;Matteo&#39;);
process.nextTick(doUncork, ws);

// as a global function
function doUncork(stream) {
  stream.uncork();
}</code></pre></div>
<p><code class="language-text">.cork()</code>å¯ä»¥è¢«è°ƒç”¨å¤šæ¬¡ï¼Œæˆ‘ä»¬åªéœ€è¦å°å¿ƒè°ƒç”¨<code class="language-text">.uncork()</code>ç›¸åŒçš„æ¬¡æ•°ï¼Œä½¿å…¶å†æ¬¡æµåŠ¨ã€‚</p>
<h2>ç»“è®º</h2>
<p>Streamsæ˜¯Node.jsä¸­ç»å¸¸ä½¿ç”¨çš„æ¨¡å—ã€‚å®ƒä»¬å¯¹äºå†…éƒ¨ç»“æ„éå¸¸é‡è¦ï¼Œå¯¹äºå¼€å‘äººå‘˜æ¥è¯´ï¼Œå®ƒä»¬å¯ä»¥è·¨Node.jsæ¨¡å—ç”Ÿæ€ç³»ç»Ÿè¿›è¡Œæ‰©å±•å’Œè¿æ¥ã€‚</p>
<p>å¸Œæœ›æ‚¨ç°åœ¨èƒ½å¤Ÿæ’é™¤æ•…éšœï¼Œå®‰å…¨åœ°ç¼–å†™æ‚¨è‡ªå·±çš„å¯å†™å’Œå¯è¯»æµçš„èƒŒæ™¯ï¼Œå¹¶ä¸åŒäº‹å’Œæœ‹å‹åˆ†äº«æ‚¨çš„çŸ¥è¯†ã€‚</p>
<p>åœ¨ä½¿ç”¨Node.jsæ„å»ºåº”ç”¨ç¨‹åºæ—¶ï¼Œè¯·åŠ¡å¿…é˜…è¯»æœ‰å…³å…¶ä»–APIå‡½æ•°çš„Streamçš„æ›´å¤šä¿¡æ¯ï¼Œä»¥å¸®åŠ©æ”¹è¿›å’Œé‡Šæ”¾æ‚¨çš„æµåŠŸèƒ½ã€‚</p></div><hr style="margin-bottom:1.75rem"/><div style="display:flex;align-items:center;margin-bottom:5.25rem"><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:50px;height:50px;margin-right:0.875rem;margin-bottom:0;min-width:50px"><img aria-hidden="true" src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAEDBAL/xAAXAQADAQAAAAAAAAAAAAAAAAABAwQA/9oADAMBAAIQAxAAAAHJdl2USXBslHQGQBv/xAAbEAACAgMBAAAAAAAAAAAAAAABAgAREBIhIv/aAAgBAQABBQJ39rtiurLEAhHFUV//xAAZEQACAwEAAAAAAAAAAAAAAAAAAQIREjH/2gAIAQMBAT8BeclC6Sbs/8QAGBEAAgMAAAAAAAAAAAAAAAAAAAEQESH/2gAIAQIBAT8B24Yj/8QAFxAAAwEAAAAAAAAAAAAAAAAAABEwMf/aAAgBAQAGPwIew//EABoQAQACAwEAAAAAAAAAAAAAAAEAESExQRD/2gAIAQEAAT8hW4cl5ahKjZ4yswK5BDZAg235P//aAAwDAQACAAMAAAAQNAjC/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAERIUH/2gAIAQMBAT8QTlWUM4Lun//EABgRAQEBAQEAAAAAAAAAAAAAAAEAESEx/9oACAECAQE/EFPq2HIGX//EABsQAQACAwEBAAAAAAAAAAAAAAEAESExQWGB/9oACAEBAAE/ELKnFsqURwKr2GEZbsLZiJAGpiDfYkyXLcIQ4xlktuf/2Q==" alt="Qinshuo(Allen) Li" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/static/0257130576977213eca55ce954451317/99438/portrait-pic.jpg 1x,
/static/0257130576977213eca55ce954451317/aba1d/portrait-pic.jpg 1.5x,
/static/0257130576977213eca55ce954451317/b315d/portrait-pic.jpg 2x" /><img loading="lazy" width="50" height="50" srcset="/static/0257130576977213eca55ce954451317/99438/portrait-pic.jpg 1x,
/static/0257130576977213eca55ce954451317/aba1d/portrait-pic.jpg 1.5x,
/static/0257130576977213eca55ce954451317/b315d/portrait-pic.jpg 2x" src="/static/0257130576977213eca55ce954451317/99438/portrait-pic.jpg" alt="Qinshuo(Allen) Li" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><span><a style="box-shadow:none" href="/about">Qinshuo(Allen) Li</a><br/>Empty Stack Engineer.</span></div><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/JavaScript-ES2018-ES9-æ–°å¢æ ‡å‡†/">â† <!-- -->JavaScript ES2018/ES9 æ–°å¢æ ‡å‡†</a></li><li><a rel="next" href="/å­¦ä¹ çš„æ„ä¹‰/">å­¦ä¹ çš„æ„ä¹‰<!-- --> â†’</a></li></ul></main></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div>
          </div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/Backpressure/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-de4b40778847a690af68.js"],"app":["/app-c5b6662e244d0f222903.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-2967fd13dd489bc26e45.js"],"component---src-pages-404-js":["/component---src-pages-404-js-6468a371550f141d4eb3.js"],"component---src-pages-about-js":["/component---src-pages-about-js-2bed458a33db416971eb.js"],"component---src-pages-index-js":["/component---src-pages-index-js-3f1a0fc3b4cf05211c36.js"],"component---src-pages-post-js":["/component---src-pages-post-js-3a5ebe773dba132ea7df.js"],"component---src-pages-project-js":["/component---src-pages-project-js-0198bbc3a3b3e250bd29.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-9409cd8b6b71cd967860.js"]};/*]]>*/</script><script src="/polyfill-de4b40778847a690af68.js" nomodule=""></script><script src="/component---src-templates-blog-post-js-9409cd8b6b71cd967860.js" async=""></script><script src="/3ff1db7653220f4faedd8b2ce788c941d30183fc-338a1c97b480401706c3.js" async=""></script><script src="/73d3d9e0165615ec1a5fd45b6214bc89c496d04c-6650e6e8db9e28320e98.js" async=""></script><script src="/styles-e9d24b1846c7d6eb9685.js" async=""></script><script src="/app-c5b6662e244d0f222903.js" async=""></script><script src="/42aef400-233a8540e28c5aa0dda4.js" async=""></script><script src="/81884799-5d3dbc1bedd73895a97b.js" async=""></script><script src="/webpack-runtime-037708c35ad0d69f813e.js" async=""></script><div style="display:none"><script>
              console.log('Halo ğŸ˜‰');
              var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
              document.write(unescape("%3Cspan id='cnzz_stat_icon_1264607064'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s19.cnzz.com/z_stat.php%3Fid%3D1264607064' type='text/javascript'%3E%3C/script%3E"));
              </script></div></body></html>